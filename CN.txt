//1)
#include <stdio.h>
#include <ctype.h>
int main() {
    char s[100];
    printf("Enter input (Ctrl+Z or Ctrl+D to stop):\n");
    while (scanf("%s", s) != EOF) {
        if (isalpha(s[0]) || s[0] == '_')
            printf("%s --> Identifier\n", s);
        else if (isdigit(s[0]))
            printf("%s --> Constant\n", s);
        else
            printf("%s --> Invalid\n", s);
    }
    return 0;
}
//input: sum = 45
//--------------------------------------------------------------------------------------------------
//2
#include <stdio.h>
#include <string.h>

char names[50][20], types[50][10];
int n = 0;

int search(char *x) {
    for (int i = 0; i < n; i++)
        if (!strcmp(x, names[i])) return i;
    return -1;
}

void insert() {
    printf("Name Type: ");
    scanf("%s %s", names[n], types[n]);
    n++;
}

void display() {
    for (int i = 0; i < n; i++)
        printf("%s\t%s\n", names[i], types[i]);
}

void del() {
    char x[20];
    printf("Delete name: ");
    scanf("%s", x);
    int i = search(x);
    if (i >= 0) {
        for (; i < n - 1; i++) {
            strcpy(names[i], names[i + 1]);
            strcpy(types[i], types[i + 1]);
        }
        n--;
    } else printf("Not found\n");
}

void modify() {
    char x[20];
    printf("Modify name: ");
    scanf("%s", x);
    int i = search(x);
    if (i >= 0) {
        printf("New type: ");
        scanf("%s", types[i]);
    } else printf("Not found\n");
}

int main() {
    int ch; char x[20];
    while (1) {
         printf("\n1.Insert\n2.Display\n3.Search\n4.Delete\n5.Modify\n6.Exit\nEnter the option: ");
        scanf("%d", &ch);
        if (ch == 1) insert();
        else if (ch == 2) display();
        else if (ch == 3) {
            printf("Search name: ");
            scanf("%s", x);
            int i = search(x);
            if (i >= 0) printf("Found: %s %s\n", names[i], types[i]);
            else printf("Not found\n");
        }
        else if (ch == 4) del();
        else if (ch == 5) modify();
        else break;
    }
}
//------------------------------------------------------------------------------------------------
//3
%{
#include <stdio.h>
%}

%%

[a-zA-Z_][a-zA-Z0-9_]*      { printf("IDENTIFIER : %s\n", yytext); }
[0-9]+(\.[0-9]+)?           { printf("CONSTANT   : %s\n", yytext); }
[ \t\n]+
.                           { printf("SYMBOL     :%s\n", yytext); }

%%

int main() {
   printf("Enter the Expression :");
    yylex();
    return 0;
}

flex lexical.l
gcc lex.yy.c -lfl -o lexical
./lexical


input: a + b + c = 10
//--------------------------------------------------------------------------------------------------
//4
//exp4.l
%{
#include "y.tab.h" 
%}

%%

[0-9]+        { return NUMBER; }
[ \t]+        { }
\n            { return '\n'; }
.             { return yytext[0]; }

%%

int yywrap() {
    return 1;
}

//exp4.y
%{
#include <stdio.h>
int yylex(void);
void yyerror(const char *s);
%}

%token NUMBER

%left '+' '-'
%left '*' '/'

%%

program: 
       | program line
       ;

line:    expr '\n'  { printf("= Valid Expression\n"); }
     |   '\n'       
     ;

expr:    NUMBER
     |   expr '+' expr
     |   expr '-' expr
     |   expr '*' expr
     |   expr '/' expr
     |   '(' expr ')'
     ;

%%

int main() {
    printf("Enter an arithmetic expression:\n");
    yyparse();
    return 0;
}

void yyerror(const char *s) {
    fprintf(stderr, "Error: Invalid syntax\n");
}

// run
yacc -d exp4.y
flex  exp4.l
gcc y.tab.c lex.yy.c -o exp4

//output:(5 + 3) * 2
//---------------------------------------------------------------------------------------------------
//5

//exp5.l
%{
#include "y.tab.h"
%}
%%
[a-zA-Z][a-zA-Z0-9]*   { return ID; }
.|\n                   { return INVALID; }
%%

int yywrap(){ return 1; }

//exp5.y
%{
#include <stdio.h>
#include <stdlib.h>
%}

%token ID INVALID

%%
S: ID       { printf("Valid Variable\n"); }
 | INVALID  { printf("Invalid Variable\n"); }
 ;
%%
int main(){
  printf("Enter variable: ");
  yyparse();
  return 0;
}
int yyerror(char *s){}

//compile and run
	yacc -d exp5.y
	lex exp5.l
	gcc y.tab.c lex.yy.c -lfl -o exp5
	./exp5
//output:
Enter variable: abc123
//---------------------------------------------------------------------------------------
//6
//exp6.l
%{
#include "y.tab.h"
extern int yylval;
%}
%%
[0-9]+      { yylval = atoi(yytext); return NUM; }
[+\-*/()=]  { return yytext[0]; }
[ \t\n]+    ;
.           ;
%%
int yywrap(){ return 1; }

//exp6.y
%{
#include <stdio.h>
#include <stdlib.h>
%}

%token NUM
%left '+' '-'
%left '*' '/'

%%
S: E '=' { printf("Result=%d\n",$1); }
 ;
E: E '+' E { $$=$1+$3; }
 | E '-' E { $$=$1-$3; }
 | E '*' E { $$=$1*$3; }
 | E '/' E { $$=$1/$3; }
 | '(' E ')' { $$=$2; }
 | NUM
 ;
%%
int main(){ printf("Enter expression: "); yyparse(); }
int yyerror(char *s){}

//run
yacc -d exp6.y
lex exp6.l
gcc y.tab.c lex.yy.c -lfl -o calc
./calc

//output:Enter expression: 10+5*2=
//---------------------------------------------------------------------------------------------------------------
//7
//exp7.l
%{
#include "y.tab.h"
#include <stdio.h>
#include <stdlib.h>
%}

%%

[0-9]+      { yylval = atoi(yytext); return NUM; }
[+\-*/=()]  { return yytext[0]; }
[ \t\n]     ;
.           { return yytext[0]; }

%%

int yywrap() { return 1; }
//exp7.y
%{
#include <stdio.h>
#include <stdlib.h>

int tempCount = 1;
int yylex(void);
int yyerror(const char *s);
%}

%token NUM
%left '+' '-'
%left '*' '/'

%%

E : E '+' E { printf("t%d = t%d + t%d\n", tempCount, tempCount-2, tempCount-1); tempCount++; }
  | E '-' E { printf("t%d = t%d - t%d\n", tempCount, tempCount-2, tempCount-1); tempCount++; }
  | E '*' E { printf("t%d = t%d * t%d\n", tempCount, tempCount-2, tempCount-1); tempCount++; }
  | E '/' E { printf("t%d = t%d / t%d\n", tempCount, tempCount-2, tempCount-1); tempCount++; }
  | '(' E ')'
  | NUM     { printf("t%d = %d\n", tempCount++, $1); }
  ;

%%

int main() {
    printf("Enter expression: ");
    yyparse();
    return 0;
}

int yyerror(const char *s) {
    printf("Invalid expression\n");
    return 0;
}


//run
lex exp7.l
yacc -d exp7.y
gcc lex.yy.c y.tab.c -o exp7
./exp7

//output:Enter expression: 3+5*2
//----------------------------------------------------------------------------------
//8
//exp8.c

#include <stdio.h>
#include <string.h>

char vars[20][10];
int n = 0;

int declared(char *x) {
    for (int i = 0; i < n; i++)
        if (!strcmp(vars[i], x)) return 1;
    return 0;
}

int main() {
    char t[10], v[10], op[5], val[10];
    printf("Enter statements (END to stop):\n");
    while (1) {
        scanf("%s", t);
        if (!strcmp(t, "END")) break;
        if (!strcmp(t, "int") || !strcmp(t, "float")) {
            scanf("%s", v);
            if (declared(v)) printf("Error: %s redeclared\n", v);
            else { strcpy(vars[n++], v); printf("Declared %s %s\n", t, v); }
        } else {
            strcpy(v, t);
            scanf("%s %s", op, val);
            if (!declared(v)) printf("Error: %s not declared\n", v);
            else printf("Valid statement: %s %s %s\n", v, op, val);
        }
    }
}

//input
int a
float b
a = 5
b = a
c = 2
int a
END
//-----------------------------------------------------------------------------------------
----------
//9
//exp9.c
#include <stdio.h>
#include <string.h>

int main() {
    char code[10][50], lhs[10][10], expr[10][50];
    int n, i, j;

    printf("Number of statements: "); scanf("%d",&n); getchar();
    for(i=0;i<n;i++) {
        fgets(code[i],50,stdin);
        code[i][strcspn(code[i],"\n")] = 0;
        sscanf(code[i], "%s = %[^\n]", lhs[i], expr[i]);
    }

    printf("\nBefore Optimization:\n");
    for(i=0;i<n;i++) printf("%s\n", code[i]);
     for(i=0;i<n;i++){
        if(lhs[i][0]=='\0') continue;
        for(j=i+1;j<n;j++){
            if(strcmp(expr[i], expr[j])==0){
                strcpy(expr[j], lhs[i]); // replace rhs with lhs of previous
                lhs[j][0] = '\0'; 
            } else {
                // replace occurrences of removed lhs in future expressions
                if(lhs[j][0]!='\0'){
                    char *p = strstr(expr[j], lhs[i]);
                    if(p) strncpy(p, lhs[i], strlen(lhs[i]));
                }
            }
        }
    }

    printf("\nAfter Optimization:\n");
    for(i=0;i<n;i++){
        if(lhs[i][0]!='\0') printf("%s = %s\n", lhs[i], expr[i]);
    }

    return 0;
}

//input:
5
t1 = a + b
t2 = a + b
t3 = t1 + c
t4 = t2 + c
t5 = t4 + d
//---------------------------------------------------------------------------------------
//10
exp10.c
#include <stdio.h>
#include <string.h>

int main() {
    char code[20][50];
    int n;
    printf("Number of statements: "); scanf("%d",&n); getchar();

    printf("Enter statements:\n");
    for(int i=0;i<n;i++) fgets(code[i],50,stdin);

    printf("\nGenerated Machine Code:\n");
    for(int i=0;i<n;i++){
        char lhs[10], op, arg1[10], arg2[10];
        if(sscanf(code[i], "%s = %s %c %s", lhs,arg1,&op,arg2)==4){
            printf("LOAD %s\n", arg1);
            switch(op){
                case '+': printf("ADD %s\n", arg2); break;
                case '-': printf("SUB %s\n", arg2); break;
                case '*': printf("MUL %s\n", arg2); break;
                case '/': printf("DIV %s\n", arg2); break;
            }
            printf("STORE %s\n", lhs);
        }
        else if(sscanf(code[i], "%s = %s", lhs,arg1)==2){
            printf("LOAD %s\nSTORE %s\n", arg1,lhs);
        }
    }
}

//input:
5
t1 = a + b
t2 = t1 * c
t3 = t2 - d
t4 = t3 / e
t5 = t4

//-----------------------------------------------------------------------------------------
//11
//exp11.l
%{
#include "y.tab.h"
%}

%%
[A-Z][a-zA-Z0-9]{5}   { return VALID_ID; }
\n                    { return '\n'; }
[ \t]+                 { /* Skip whitespace */ }

.                     { return yytext[0]; }
%%

int yywrap() {
    return 1;
}
//exp11.y
  GNU nano 7.2                    exp11.y
%{
#include <stdio.h>
extern int yylex(void);
void yyerror(const char *s) {
    fprintf(stderr, "Error: Invalid syntax\n");
}
%}

%token VALID_ID

%%
program:
       | program line
       ;

line:    VALID_ID '\n'  { printf("OK: Found a valid statement\n"); }
     |   '\n'
     ;
%%

int main(void) {
    printf("Enter statements (e.g., A12345 or Kp2x9):\n");
    yyparse();
    return 0;
}

//run
yacc -d exp11.y
flex exp11.l
gcc y.tab.c lex.yy.c -o exp11
./exp11

//output:A12345 , hello ....
//--------------------------------------------------------------------------------------------------------------------------
//12
//exp12.l
%{
#include <stdio.h>
extern FILE *yyin;
%}

%%

[ \t\n]+          ;

"//".* ;
"/*"([^*]|(\*+[^*/]))*\*+"/"  ;

"if"|"else"|"for"|"while"|"return"  { printf("Keyword: %s\n", yytext); }

"=="|"="|"+"|"-"|"*"|"/"            { printf("Operator: %s\n", yytext); }

[a-zA-Z_][a-zA-Z0-9_]* { printf("Identifier: %s\n", yytext); }

[0-9]+                              { printf("Number: %s\n", yytext); }

.                                   { printf("Other: %s\n", yytext); }

%%

int main(int argc, char *argv[]) {
    if (argc < 2) {
        fprintf(stderr, "Usage: %s <filename>\n", argv[0]);
        return 1;
    }
    
    FILE *file = fopen(argv[1], "r");
    if (!file) {
        perror(argv[1]);
        return 1;
    }
    
    yyin = file;
    yylex();
    
    fclose(file);
    return 0;
}

int yywrap() { 
    return 1; 
}

//input file: nano exp12input.txt
//exp12input.txt

//  program
int x = 10;
if (x == 10) {
    return 0;
}
/* end */

//run
flex exp12.l
gcc lex.yy.c -o exp12

//output
./exp12 exp12input.txt

//-------------------------------------------------------------------------------------------------------------------------------
//13
//exp13.l
%{
#include <stdio.h>
extern FILE *yyin;
%}

%%

[ \t\n]+       ;
"//".*          ;
"/*"([^*]|\*+[^*/])*"*"+"/" ;

"if"|"else"|"for"|"while"|"switch"|"case"|"default"  { printf("%s\n", yytext); }

.               ;

%%

int main(int argc,char **argv){
printf("control statements in the program are :\n");
    if(argc < 2){
        printf("Usage: %s <inputfile>\n", argv[0]);
        return 0;
    }

    yyin = fopen(argv[1], "r");
    if(!yyin){
        printf("Cannot open %s\n", argv[1]);
        return 0;
    }

    yylex();                    
    fclose(yyin);
}

int yywrap(){ return 1; }


//input:exp13input.c
if(a==b)
for(i=0;i<10;i++)
else
switch(x)
case 1:
default

//run
flex exp13.l
gcc lex.yy.c -o exp13
./exp13 exp13input.c

//---------------------------------------------------------------------------------------

//14
%{
#include <stdio.h>
int vowels = 0, consonants = 0;
%}

%%

[aeiouAEIOU] { vowels++; }

[a-zA-Z]     { consonants++; }

.            ;

%%

int main(){
    printf("Enter text:\n");
    yylex();
    printf("Vowels: %d\nConsonants: %d\n", vowels, consonants);
    return 0;
}

int yywrap(){ 
    return 1; 
}

//run 
flex exp14.l
gcc lex.yy.c -o exp14
./exp14

//input : Hello World then press enter and then ctrl+D

//-----------------------------------------------------------------------------------------
//15
//exp15.c
#include <stdio.h>
#include <string.h>
#include <ctype.h>

char stack[100][10];
int top=-1;

void push(char *s){ strcpy(stack[++top], s); }
char* pop(){ return stack[top--]; }

int main(){
    char exp[100], t[3]; 
    int temp=1;
    printf("Enter postfix: ");
    scanf("%s", exp);

    for(int i=0; i<strlen(exp); i++){
        if(isalpha(exp[i])){ t[0]=exp[i]; t[1]='\0'; push(t); }
        else{
            char *b=pop(), *a=pop();
            printf("t%d = %s %c %s\n", temp, a, exp[i], b);
            sprintf(t, "t%d", temp++);
            push(t);
        }
    }
}

//run: 
gcc exp15.c -o exp15
 ./exp15
//input:Enter postfix:  ab+c*
//-----------------------------------------------------------------------------------------

//16
//exp16.c
%{
#include <stdio.h>
%}

%%

[ \t\n]+       ;

"if"|"else"|"for"|"while"|"switch"|"case"|"default"  { printf("Keyword: %s\n", yytext); }
"=="|"="|"+"|"-"|"*"|"/"                             { printf("Operator: %s\n", yytext); }
[a-zA-Z_][a-zA-Z0-9_]*                               { printf("Identifier: %s\n", yytext); }

. ;

%%

int main(){
    printf("Enter C code:\n");
    yylex();
}
int yywrap(){ return 1; }

//run
flex exp16.l
gcc lex.yy.c -o exp16
./exp16

//input:if(a==b) a=a+1;

//------------------------------------------------------------------------------------
//17
//exp17.c
#include <stdio.h>
#include <string.h>
int main()
{
    char result[10], arg1[10], op[5], arg2[10];
    printf("Enter Three Address Code :\n");
    printf("Input: ");
    scanf("%s = %s %s %s", result, arg1, op, arg2);
    printf("\nEquivalent Assembly Code:\n");
    printf("MOV R1, %s\n", arg1);
    if (strcmp(op, "+") == 0)
        printf("ADD R1, %s\n", arg2);
    else if (strcmp(op, "-") == 0)
        printf("SUB R1, %s\n", arg2);
    else if (strcmp(op, "*") == 0)
        printf("MUL R1, %s\n", arg2);
    else if (strcmp(op, "/") == 0)
        printf("DIV R1, %s\n", arg2);
    else
        printf("; Unsupported operator\n");
    printf("MOV %s, R1\n", result);

    return 0;
}

/*
Input: t = a + b
*/


//------------------------------------------------------------------------------------
//18
//exp18.c
#include <stdio.h>
#include <string.h>

int main() {
    char input[100];
    char non_terminal;
    char check_terminal;
    char alpha[20];
    char beta[20];

    printf("Enter a production (e.g., E->E+T|T): ");
    scanf("%s", input);

    int result = sscanf(input, "%c->%c%[^|]|%s", &non_terminal, &check_terminal, alpha, beta);

    if (result == 4 && non_terminal == check_terminal) {
        printf("\nLeft recursion detected.\n");
        printf("Grammar after elimination:\n\n");
        
        printf("%c -> %s%c'\n", non_terminal, beta, non_terminal);
        
        printf("%c' -> %s%c' | epsilon\n", non_terminal, alpha, non_terminal);
        
    } else {
        printf("\nInput is not in the format 'A->A(alpha)|(beta)' or has no left recursion.\n");
    }

    return 0;
}
//input:E->E+T|T
//------------------------------------------------------------------------------------

//19
//exp19.c
#include <stdio.h>
#include <ctype.h>

char val[100];
int left[100], right[100], idx=0;

int createAST(char *exp, int *i){
    int id = idx++;
    val[id] = exp[(*i)++];
    left[id] = right[id] = -1;
    if(val[id]=='+'||val[id]=='-'||val[id]=='*'||val[id]=='/'){
        left[id] = createAST(exp,i);
        right[id] = createAST(exp,i);
    }
    return id;
}

void printTree(int id, int level){
    if(id==-1) return;
    for(int i=0;i<level;i++) printf("    ");
    printf("%c\n", val[id]);
    printTree(left[id], level+1);
    printTree(right[id], level+1);
}

int main(){
    char exp[100], clean[100];
    printf("Enter prefix expression: ");
    fgets(exp, sizeof(exp), stdin);

    // remove spaces
    int k=0;
    for(int i=0; exp[i]; i++)
        if(exp[i]!=' ' && exp[i]!='\n') clean[k++] = exp[i];
    clean[k] = '\0';

    int i=0;
    int root = createAST(clean,&i);
    printf("AST Tree:\n");
    printTree(root,0);
}

//input:+ a * b c
//---------------------------------------------------------------------------------------
//20
#include <stdio.h>
#include <stdlib.h>

char *input;

void E();
void E_prime();
void T();

void error() {
    printf("Error: String not accepted\n");
    exit(1);
}

void match(char token) {
    if (*input == token) {
        input++;
    } else {
        error();
    }
}

void T() {
    if (*input == 'i') {
        match('i');
    } else {
        error();
    }
}

void E_prime() {
    if (*input == '+') {
        match('+');
        T();
        E_prime();
    }
}

void E() {
    T();
    E_prime();
}

int main() {
    char buffer[100];
    printf("Enter string (e.g., i+i+i): ");
    scanf("%s", buffer);
    input = buffer;

    E();

    if (*input == '\0') {
        printf("Success: String accepted\n");
    } else {
        error();
    }
    
    return 0;
}
//input: i+i
//---------------------------------------------------------------------------------



